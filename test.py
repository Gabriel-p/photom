import numpy as np
from matplotlib import pyplot as plt

# import os
# from os.path import join, realpath, dirname
# import imexam
# mypath = realpath(join(os.getcwd(), dirname(__file__)))
# image_file = mypath + '/standards/filt_V/stk_2147.fits'
# viewer = imexam.connect()
# viewer.load_fits(image_file)
# viewer.scale()
# viewer.imexam()


# # pixel coordinates (integer)
# x, y = np.mgrid[:100, :100]
# print(np.shape(x))
# # centroids (float)
# cx, cy = np.random.rand(2, 9) * 100

# # a Gaussian kernel to represent the PSF
# def gausskern(x, y, cx, cy, sigma):
#     return np.exp(-((x - cx) ** 2 + (y - cy) ** 2) / (2 * sigma ** 2))

# # (nstars, ny, nx)
# stars = gausskern(x[None, ...], y[None, ...],
#                   cx[:, None, None], cy[:, None, None], 10)

# # add some noise for extra realism
# stars += np.random.randn(*stars.shape) * 0.5

stars = np.array([[[81.0877456665039, 72.20025634765625, 81.35356903076172, 95.69291687011719, 98.58824920654297, 120.07198333740234, 110.90243530273438, 150.90383911132812, 132.27235412597656, 143.10379028320312, 148.330078125, 149.8959503173828, 103.36012268066406, 123.48410034179688, 92.94200897216797, 101.52523803710938, 65.11166381835938, 80.8579330444336, 105.46150970458984, 65.02442932128906], [80.32891845703125, 94.13763427734375, 58.8225212097168, 120.8482437133789, 111.47762298583984, 147.11773681640625, 173.4169158935547, 159.4974365234375, 210.7466278076172, 230.98193359375, 222.98031616210938, 178.35691833496094, 152.48680114746094, 149.41783142089844, 137.0716552734375, 121.09530639648438, 82.66327667236328, 70.77682495117188, 64.45935821533203, 75.97582244873047], [86.64920806884766, 86.34037780761719, 114.51717376708984, 119.40320587158203, 174.9265594482422, 228.82131958007812, 238.2886962890625, 295.9507751464844, 341.0895080566406, 321.990478515625, 310.26580810546875, 289.6716613769531, 214.00991821289062, 203.6058807373047, 168.79171752929688, 132.32757568359375, 104.53547668457031, 86.5609130859375, 69.31120300292969, 96.63943481445312], [95.44883728027344, 118.2542953491211, 125.02434539794922, 192.6929473876953, 239.26683044433594, 310.07562255859375, 418.5545959472656, 485.2928161621094, 586.5604858398438, 584.6384887695312, 512.7789916992188, 465.7845764160156, 367.577880859375, 296.9727783203125, 219.99224853515625, 190.19125366210938, 132.205078125, 116.34720611572266, 93.25894927978516, 88.6077880859375], [99.26293182373047, 129.1146697998047, 186.92120361328125, 219.2568817138672, 386.3425598144531, 629.8782348632812, 782.74609375, 1060.4072265625, 1148.1134033203125, 1234.7723388671875, 1146.156982421875, 879.010009765625, 709.7703857421875, 513.8359985351562, 357.61968994140625, 257.10986328125, 182.12828063964844, 131.52926635742188, 115.97351837158203, 72.85450744628906], [100.9166030883789, 138.67874145507812, 237.42196655273438, 397.10870361328125, 683.98876953125, 1106.58056640625, 1599.77783203125, 2253.449951171875, 2551.160400390625, 2633.067626953125, 2410.433837890625, 1969.4761962890625, 1450.5841064453125, 948.774169921875, 589.517578125, 357.1249084472656, 247.78781127929688, 174.79507446289062, 117.3412857055664, 108.41574096679688], [136.2401885986328, 180.20437622070312, 278.921875, 553.6857299804688, 1065.9908447265625, 2022.758544921875, 3327.642333984375, 4664.115234375, 5802.859375, 5919.84326171875, 5437.69482421875, 4293.85986328125, 3075.998046875, 1982.7750244140625, 1108.3037109375, 594.0311279296875, 355.3163146972656, 210.14059448242188, 144.57220458984375, 114.50919342041016], [118.3250503540039, 208.82302856445312, 356.9596252441406, 726.2432861328125, 1551.64208984375, 3279.923095703125, 5956.86328125, 9013.208984375, 11284.0791015625, 12119.1728515625, 11051.4853515625, 8729.5712890625, 5919.18505859375, 3532.57666015625, 1835.3319091796875, 882.0611572265625, 450.72503662109375, 261.5640563964844, 160.90292358398438, 130.00650024414062], [155.26634216308594, 244.55381774902344, 438.3097839355469, 877.5961303710938, 1967.90869140625, 4320.76416015625, 8604.3125, 13890.87109375, 18050.08203125, 19429.107421875, 18216.083984375, 14079.9892578125, 9188.857421875, 5088.60888671875, 2581.98193359375, 1153.8594970703125, 544.9390869140625, 279.5747985839844, 174.3914794921875, 137.72833251953125], [180.23875427246094, 275.8594055175781, 425.8777770996094, 895.6434936523438, 2149.08056640625, 4778.61181640625, 9675.638671875, 15979.3125, 21800.1640625, 23861.525390625, 22090.09765625, 16827.689453125, 10702.458984375, 5590.72412109375, 2736.410400390625, 1218.478759765625, 594.299072265625, 278.4292297363281, 210.10321044921875, 144.88412475585938], [164.7560272216797, 245.83053588867188, 392.9959716796875, 752.7308349609375, 1820.014892578125, 3957.359130859375, 8013.55078125, 13666.919921875, 18701.232421875, 20748.08984375, 18986.150390625, 14458.7001953125, 8934.357421875, 4587.12939453125, 2282.039794921875, 1091.0203857421875, 553.359619140625, 312.4525451660156, 185.3662872314453, 132.98255920410156], [174.4840850830078, 189.59410095214844, 386.2763977050781, 621.1939697265625, 1262.985107421875, 2485.62158203125, 4836.5, 8311.5087890625, 11206.4404296875, 12875.205078125, 11627.568359375, 8892.810546875, 5669.677734375, 3190.430419921875, 1611.0765380859375, 787.6980590820312, 468.5984191894531, 259.36163330078125, 188.98655700683594, 152.3803253173828], [141.71006774902344, 180.4727020263672, 237.23049926757812, 471.4060363769531, 766.2279663085938, 1450.8333740234375, 2463.623779296875, 3973.288818359375, 5298.7548828125, 5956.365234375, 5660.033203125, 4420.064453125, 2852.97314453125, 1827.6986083984375, 1053.0723876953125, 615.6336669921875, 356.4011535644531, 215.0291290283203, 176.0520477294922, 155.24032592773438], [102.19525146484375, 143.42678833007812, 216.79566955566406, 298.6114196777344, 455.7176208496094, 791.9987182617188, 1235.060302734375, 1750.94189453125, 2176.335205078125, 2453.793701171875, 2367.205078125, 2004.19140625, 1412.6500244140625, 1006.616455078125, 587.1828002929688, 407.27142333984375, 290.2083435058594, 206.31324768066406, 138.9099884033203, 98.37882995605469], [118.80760955810547, 125.90325927734375, 152.880615234375, 201.26683044433594, 301.9187316894531, 437.6020202636719, 618.7383422851562, 784.1616821289062, 876.2816162109375, 1085.275146484375, 1010.3751220703125, 908.4423828125, 718.5801391601562, 534.0413208007812, 394.72015380859375, 291.166748046875, 248.9472198486328, 162.26597595214844, 127.54533386230469, 116.01569366455078], [90.91535949707031, 110.42317962646484, 125.79109954833984, 152.82017517089844, 206.3999786376953, 240.9889373779297, 343.5788879394531, 404.4966125488281, 490.7269592285156, 531.1515502929688, 515.6019287109375, 480.5713195800781, 374.43560791015625, 334.44384765625, 273.3368225097656, 214.86766052246094, 180.75010681152344, 140.3282928466797, 104.19342803955078, 94.40867614746094], [101.33116912841797, 82.6089859008789, 119.65228271484375, 93.38844299316406, 130.4067840576172, 168.6029815673828, 226.07699584960938, 235.66151428222656, 310.7132873535156, 299.300537109375, 253.11578369140625, 284.2494812011719, 232.12930297851562, 229.7476806640625, 191.46084594726562, 179.99832153320312, 134.0890655517578, 125.87511444091797, 105.8415298461914, 89.91133880615234], [63.30876541137695, 68.86751556396484, 109.34989166259766, 82.60932922363281, 98.88661193847656, 126.3726577758789, 139.80746459960938, 164.530029296875, 188.08099365234375, 189.20657348632812, 175.5261688232422, 185.615966796875, 162.38990783691406, 149.37937927246094, 143.2771453857422, 118.07667541503906, 120.82569122314453, 78.34398651123047, 96.04209899902344, 73.31061553955078], [65.00544738769531, 72.13750457763672, 63.98257827758789, 90.87431335449219, 102.14276885986328, 93.10973358154297, 113.61307525634766, 136.20571899414062, 156.75332641601562, 134.88369750976562, 122.69448852539062, 123.54806518554688, 130.2218780517578, 123.4585189819336, 104.84669494628906, 89.25618743896484, 104.61680603027344, 93.52731323242188, 88.7340087890625, 78.51959991455078], [63.45774841308594, 57.1051025390625, 61.9881591796875, 72.00911712646484, 95.32671356201172, 81.48860931396484, 90.2791519165039, 104.95452880859375, 103.42203521728516, 115.24195098876953, 112.02787017822266, 121.46343994140625, 95.11868286132812, 116.68251037597656, 92.15303802490234, 87.87966918945312, 82.92687225341797, 66.8604965209961, 68.23916625976562, 68.94928741455078]], [[82.31624603271484, 81.04936981201172, 99.37380981445312, 129.07774353027344, 127.30106353759766, 174.4027862548828, 172.5828857421875, 206.8380126953125, 173.63255310058594, 168.51040649414062, 139.90472412109375, 146.40365600585938, 118.70126342773438, 100.00916290283203, 121.70594787597656, 94.74449920654297, 90.2733383178711, 81.10726165771484, 50.92069625854492, 74.6873779296875], [75.18844604492188, 113.73137664794922, 139.33299255371094, 165.91929626464844, 205.8927459716797, 231.994384765625, 242.31155395507812, 301.9856262207031, 276.8471374511719, 266.60748291015625, 228.34286499023438, 191.16026306152344, 150.71607971191406, 140.39871215820312, 101.68717956542969, 93.18826293945312, 85.01097869873047, 75.2129135131836, 67.91371154785156, 63.804996490478516], [103.89034271240234, 134.7251739501953, 135.95309448242188, 202.6511993408203, 337.1996765136719, 442.0567626953125, 476.9486999511719, 483.3085632324219, 481.2944641113281, 430.02496337890625, 383.2345886230469, 328.8476257324219, 221.90989685058594, 204.40704345703125, 147.23121643066406, 141.69052124023438, 106.3586196899414, 84.48471069335938, 65.9521484375, 63.46134948730469], [120.22796630859375, 151.70819091796875, 223.89073181152344, 295.6847229003906, 511.0793151855469, 775.0153198242188, 954.5517578125, 1047.857421875, 966.0197143554688, 883.89990234375, 712.2681274414062, 555.8074340820312, 360.0077819824219, 286.0489807128906, 223.34109497070312, 163.32395935058594, 127.35523986816406, 104.27040100097656, 84.16609954833984, 73.20901489257812], [161.36019897460938, 166.54342651367188, 293.56781005859375, 501.58245849609375, 915.616943359375, 1388.0667724609375, 1899.7899169921875, 2150.27490234375, 2153.22509765625, 1876.0411376953125, 1368.244140625, 1007.27685546875, 664.3427124023438, 439.40142822265625, 300.8970947265625, 217.3431854248047, 159.02157592773438, 106.19901275634766, 101.00273132324219, 65.9720230102539], [153.12646484375, 180.9571075439453, 358.17535400390625, 675.0698852539062, 1216.309326171875, 2405.450927734375, 3473.95556640625, 4376.576171875, 4294.31005859375, 3731.77587890625, 2854.44775390625, 1999.7998046875, 1231.8609619140625, 726.8729248046875, 445.5616455078125, 248.0109405517578, 190.23101806640625, 98.93067932128906, 100.11280822753906, 91.64237976074219], [172.00900268554688, 239.79302978515625, 369.2188720703125, 796.5927734375, 1668.2509765625, 3256.785888671875, 5292.0712890625, 7501.14794921875, 8026.5400390625, 7161.06982421875, 5410.23876953125, 3692.756103515625, 2185.360107421875, 1265.0947265625, 671.4345092773438, 391.1000671386719, 223.56996154785156, 166.02474975585938, 116.57879638671875, 105.19888305664062], [155.0177764892578, 268.6087951660156, 426.3814392089844, 919.7645874023438, 1935.85888671875, 4047.166748046875, 7390.8232421875, 10937.3916015625, 12952.8583984375, 12155.005859375, 9361.56640625, 6071.4462890625, 3517.26123046875, 1870.88330078125, 1016.2639770507812, 491.1623840332031, 269.8604736328125, 183.6211700439453, 149.74029541015625, 92.70137023925781], [167.75758361816406, 257.427734375, 460.9389343261719, 985.26904296875, 2101.577392578125, 4418.53466796875, 8264.73828125, 13108.8134765625, 16791.166015625, 16696.576171875, 13284.3056640625, 8973.33203125, 5248.0771484375, 2675.822265625, 1297.5367431640625, 652.2548828125, 337.3214416503906, 211.2544403076172, 148.69969177246094, 113.38066101074219], [157.88775634765625, 239.17491149902344, 473.8292541503906, 904.0294799804688, 1971.2635498046875, 4010.5498046875, 7585.47119140625, 12420.3212890625, 16862.255859375, 18360.505859375, 15358.6298828125, 10482.8857421875, 6259.85009765625, 3181.6240234375, 1505.1805419921875, 737.2381591796875, 329.6864013671875, 235.3798065185547, 160.68191528320312, 109.4967269897461], [171.10414123535156, 207.8627471923828, 398.85272216796875, 720.4022216796875, 1470.80419921875, 2877.825927734375, 5408.5830078125, 9056.3232421875, 12928.4228515625, 15019.2099609375, 13572.9560546875, 9784.94921875, 5944.2958984375, 3124.104736328125, 1438.39111328125, 612.26416015625, 344.6603698730469, 197.8974151611328, 145.87493896484375, 129.09866333007812], [130.83360290527344, 195.57904052734375, 331.8334655761719, 507.990966796875, 975.6342163085938, 1807.6282958984375, 3146.991943359375, 5218.72314453125, 7414.94384765625, 9063.087890625, 8593.8935546875, 6768.521484375, 4288.9365234375, 2239.578369140625, 1115.810791015625, 521.5753784179688, 302.59405517578125, 194.51370239257812, 117.91136932373047, 124.91211700439453], [116.36114501953125, 151.47470092773438, 239.58486938476562, 331.462890625, 598.5992431640625, 988.2254638671875, 1664.103759765625, 2394.376220703125, 3281.231689453125, 4027.236328125, 4222.3525390625, 3352.1845703125, 2262.1865234375, 1280.1666259765625, 745.0809326171875, 360.5732116699219, 222.00991821289062, 148.77378845214844, 131.47625732421875, 85.85172271728516], [80.24488067626953, 141.2061309814453, 182.83975219726562, 244.7992401123047, 343.60626220703125, 556.43798828125, 743.0333862304688, 1053.3375244140625, 1379.5777587890625, 1727.561767578125, 1670.46044921875, 1474.895751953125, 1071.162841796875, 734.347412109375, 396.9373779296875, 267.0265197753906, 179.46112060546875, 138.90625, 104.7360610961914, 78.95841217041016], [71.56634521484375, 115.88356018066406, 100.98080444335938, 174.27723693847656, 224.28562927246094, 316.86676025390625, 435.6188659667969, 530.5328369140625, 661.653564453125, 707.482177734375, 672.0328979492188, 624.0369262695312, 535.2928466796875, 384.94183349609375, 256.1314697265625, 188.826171875, 136.63526916503906, 115.66912841796875, 95.67715454101562, 79.48345947265625], [66.81178283691406, 98.44449615478516, 108.12451934814453, 116.16769409179688, 170.68124389648438, 182.1068572998047, 237.28573608398438, 277.8184509277344, 300.45794677734375, 377.08404541015625, 328.6278991699219, 312.8466491699219, 249.9950714111328, 194.7193145751953, 145.5274658203125, 132.42698669433594, 92.30217742919922, 87.74283599853516, 89.89044189453125, 92.28549194335938], [67.15380859375, 67.2974624633789, 103.78475952148438, 116.45525360107422, 114.2751235961914, 128.95111083984375, 173.51011657714844, 149.57388305664062, 196.31114196777344, 193.5446014404297, 231.5209197998047, 169.50030517578125, 171.2620849609375, 158.5560760498047, 112.45745086669922, 111.08716583251953, 95.07794189453125, 94.79031372070312, 66.93701171875, 60.68362045288086], [75.53460693359375, 71.18311309814453, 57.65678405761719, 75.74402618408203, 91.74541473388672, 109.8471450805664, 117.23003387451172, 140.3647918701172, 108.67667388916016, 141.79476928710938, 123.15008544921875, 142.93557739257812, 106.56743621826172, 95.27263641357422, 98.50700378417969, 77.40974426269531, 81.8844985961914, 78.133544921875, 76.2262954711914, 61.24431610107422], [57.35895919799805, 56.1207160949707, 62.539424896240234, 69.88737487792969, 70.46209716796875, 72.9053726196289, 105.13308715820312, 100.3781967163086, 107.92692565917969, 102.12564849853516, 85.6572265625, 104.65941619873047, 104.55258178710938, 102.60240173339844, 73.82746124267578, 92.68689727783203, 77.13838958740234, 71.05758666992188, 61.32425308227539, 60.1460075378418], [63.98798370361328, 50.1775016784668, 77.50330352783203, 72.89806365966797, 69.0686264038086, 78.35413360595703, 74.2532958984375, 87.75015258789062, 93.57515716552734, 96.42926025390625, 92.1846694946289, 55.07640075683594, 75.3062973022461, 91.83641052246094, 69.27875518798828, 82.21683502197266, 57.9898796081543, 68.83171844482422, 82.14007568359375, 61.14186477661133]], [[73.36498260498047, 79.83090209960938, 66.94519805908203, 60.31684112548828, 92.95790100097656, 72.5954818725586, 87.88494110107422, 100.86078643798828, 91.83718872070312, 96.85874938964844, 120.43256378173828, 101.15679931640625, 86.06926727294922, 80.55927276611328, 80.40950775146484, 81.36947631835938, 78.77472686767578, 72.25328826904297, 63.41503143310547, 54.435691833496094], [64.22693634033203, 56.32482147216797, 83.56465911865234, 89.52718353271484, 109.42667388916016, 108.86290740966797, 144.4427490234375, 126.43992614746094, 160.17721557617188, 140.79144287109375, 120.43394470214844, 121.91850280761719, 136.18299865722656, 102.0699234008789, 99.8133544921875, 79.12159729003906, 92.60100555419922, 62.711700439453125, 63.737056732177734, 69.05020904541016], [74.23552703857422, 73.46317291259766, 91.10575103759766, 110.74464416503906, 114.95999908447266, 125.95655822753906, 159.5021514892578, 199.69302368164062, 227.02786254882812, 217.46571350097656, 207.45681762695312, 176.69265747070312, 163.55191040039062, 137.6550750732422, 119.08120727539062, 107.38479614257812, 94.81241607666016, 86.64171600341797, 79.9475326538086, 73.88089752197266], [85.29706573486328, 97.50968170166016, 93.83940124511719, 119.0848388671875, 135.18203735351562, 210.7415313720703, 262.3442077636719, 355.15618896484375, 333.50469970703125, 360.6886291503906, 373.54400634765625, 295.5710144042969, 257.5057678222656, 224.1949005126953, 176.28919982910156, 147.4169158935547, 95.22659301757812, 94.79708862304688, 83.68031311035156, 87.56198120117188], [88.26974487304688, 102.92626190185547, 118.30440521240234, 178.4551239013672, 258.9306945800781, 394.1185302734375, 486.9228210449219, 602.4539794921875, 699.4004516601562, 690.5557250976562, 673.7172241210938, 478.03094482421875, 452.62725830078125, 325.04559326171875, 243.7197265625, 161.84254455566406, 143.07754516601562, 116.29962158203125, 84.89215850830078, 67.20288848876953], [104.3172836303711, 132.75201416015625, 151.61346435546875, 236.82516479492188, 405.7791442871094, 724.2722778320312, 1008.3367919921875, 1321.0084228515625, 1478.11328125, 1542.4952392578125, 1446.8641357421875, 1110.70361328125, 871.8919067382812, 612.356689453125, 370.2308044433594, 252.54934692382812, 187.09783935546875, 124.24765014648438, 99.78462219238281, 64.15308380126953], [94.84571075439453, 137.08251953125, 201.2942657470703, 340.61810302734375, 588.0533447265625, 1084.391357421875, 1868.8074951171875, 2686.95068359375, 3230.634765625, 3426.493896484375, 3064.212158203125, 2544.893798828125, 1774.7982177734375, 1234.6890869140625, 688.2039794921875, 390.8674621582031, 230.3362579345703, 165.24557495117188, 105.42884063720703, 91.51209259033203], [120.41670989990234, 115.39407348632812, 230.14964294433594, 448.1810302734375, 808.0567626953125, 1763.8609619140625, 3361.513671875, 5217.8505859375, 6814.09033203125, 7066.85205078125, 6389.85791015625, 5009.97265625, 3399.54052734375, 2111.787841796875, 1146.68310546875, 591.7137451171875, 301.99267578125, 192.707275390625, 122.96227264404297, 91.03765106201172], [112.29335021972656, 169.93783569335938, 222.2217254638672, 477.4833679199219, 1062.29443359375, 2440.225830078125, 4783.69091796875, 8146.2919921875, 10877.4970703125, 11922.9599609375, 10945.861328125, 8529.9599609375, 5419.39404296875, 3267.522705078125, 1694.887451171875, 795.1611938476562, 403.1799621582031, 242.36538696289062, 170.87420654296875, 104.36932373046875], [103.09535217285156, 175.82618713378906, 265.5772399902344, 498.20208740234375, 1112.575439453125, 2698.0224609375, 5719.66845703125, 10156.376953125, 13824.1064453125, 15449.001953125, 13886.1669921875, 10719.1171875, 7009.11865234375, 3955.982421875, 1922.38720703125, 980.1847534179688, 467.79693603515625, 248.18014526367188, 161.80374145507812, 111.79757690429688], [117.92549133300781, 150.7790985107422, 252.67640686035156, 485.11871337890625, 1013.495361328125, 2239.9267578125, 4927.47265625, 8536.4453125, 12284.5771484375, 14057.22265625, 13103.8232421875, 9955.1455078125, 6421.09765625, 3477.353515625, 1843.1165771484375, 889.5717163085938, 398.41448974609375, 247.52444458007812, 170.09921264648438, 115.78146362304688], [101.74982452392578, 166.0860595703125, 194.77679443359375, 406.5421142578125, 749.21484375, 1549.84326171875, 3136.387451171875, 5263.8994140625, 7692.52685546875, 9276.265625, 8840.5634765625, 6887.21923828125, 4343.79443359375, 2497.41796875, 1333.6041259765625, 731.3489379882812, 400.66790771484375, 243.00477600097656, 159.813232421875, 128.8834991455078], [98.1347885131836, 121.05206298828125, 183.31402587890625, 281.1421203613281, 494.6642761230469, 939.4048461914062, 1550.1480712890625, 2629.111572265625, 3686.798828125, 4480.42919921875, 4494.6689453125, 3530.69921875, 2432.836669921875, 1485.7716064453125, 852.7069091796875, 543.8698120117188, 321.9720764160156, 204.59234619140625, 155.96966552734375, 126.60018920898438], [77.85333251953125, 108.45609283447266, 150.47630310058594, 184.1448974609375, 305.9930419921875, 512.7241821289062, 798.6841430664062, 1236.9786376953125, 1508.1112060546875, 1880.4134521484375, 1877.2803955078125, 1571.57958984375, 1201.86669921875, 811.8966674804688, 527.7977294921875, 389.9190673828125, 255.32240295410156, 160.13754272460938, 147.2505645751953, 108.8284683227539], [73.66341400146484, 78.62098693847656, 125.1612319946289, 194.47381591796875, 203.4015655517578, 316.8928527832031, 420.77044677734375, 539.2357177734375, 733.8765869140625, 813.2655029296875, 785.5806274414062, 757.764404296875, 618.43017578125, 457.02105712890625, 381.6092224121094, 255.21209716796875, 161.10633850097656, 131.28488159179688, 123.0525894165039, 70.23880004882812], [75.35430145263672, 75.99874114990234, 112.03396606445312, 125.01065826416016, 145.0226287841797, 190.94039916992188, 223.2730255126953, 285.5843505859375, 359.8580627441406, 395.0668029785156, 388.2708435058594, 391.38818359375, 331.8912048339844, 313.8447265625, 204.68948364257812, 188.5901641845703, 161.92567443847656, 112.28297424316406, 87.50245666503906, 86.78543853759766], [64.5021743774414, 87.54578399658203, 83.611328125, 104.34529876708984, 114.45564270019531, 149.97955322265625, 169.15240478515625, 158.41949462890625, 204.053955078125, 215.37347412109375, 240.1941375732422, 215.39984130859375, 195.4182891845703, 171.80967712402344, 146.99156188964844, 155.3485870361328, 117.1441421508789, 105.24285888671875, 81.10040283203125, 88.92401123046875], [65.96807098388672, 52.50601577758789, 71.62283325195312, 90.63160705566406, 85.00491333007812, 123.3220443725586, 109.99820709228516, 145.0179443359375, 124.49916076660156, 152.75030517578125, 141.61050415039062, 111.57746887207031, 163.10679626464844, 127.38457489013672, 117.40863800048828, 102.2032699584961, 110.6242446899414, 75.26134490966797, 91.94754028320312, 83.66492462158203], [66.85237884521484, 61.86103057861328, 90.21621704101562, 72.40589141845703, 83.77970886230469, 95.71723937988281, 98.5888442993164, 108.13411712646484, 101.77940368652344, 116.39420318603516, 125.05668640136719, 126.00711822509766, 108.25678253173828, 82.54946899414062, 99.8283920288086, 91.63035583496094, 82.9428939819336, 90.76681518554688, 81.93639373779297, 69.28653717041016], [76.88323974609375, 64.27421569824219, 66.62761688232422, 70.0413589477539, 70.33610534667969, 75.8410873413086, 94.27880096435547, 83.11984252929688, 105.88615417480469, 88.59860229492188, 76.90164947509766, 76.34957885742188, 84.8764877319336, 87.57820892333984, 76.17445373535156, 86.77278137207031, 76.1528091430664, 82.08333587646484, 72.53641510009766, 58.001441955566406]], [[70.99577331542969, 77.85649108886719, 93.0814437866211, 94.70396423339844, 83.85176086425781, 110.144775390625, 96.26543426513672, 109.7267074584961, 136.7756805419922, 108.4059829711914, 116.12340545654297, 126.70198059082031, 106.9654769897461, 80.47726440429688, 70.7056884765625, 66.39031982421875, 54.450252532958984, 57.97203826904297, 66.82564544677734, 80.00192260742188], [71.17460632324219, 69.81317901611328, 87.17647552490234, 109.0484619140625, 124.98615264892578, 146.61659240722656, 143.81539916992188, 169.11927795410156, 170.9189910888672, 154.80868530273438, 139.0853271484375, 125.70380401611328, 118.94705200195312, 107.0096206665039, 79.5710678100586, 70.79527282714844, 71.39996337890625, 71.4769058227539, 65.30416107177734, 64.51384735107422], [89.14521789550781, 98.76544952392578, 138.58084106445312, 152.35072326660156, 163.32540893554688, 185.1678466796875, 250.94227600097656, 288.5540466308594, 288.07073974609375, 251.3107452392578, 231.21127319335938, 189.31349182128906, 180.41390991210938, 128.14149475097656, 108.67374420166016, 94.42724609375, 78.5631332397461, 68.85614013671875, 57.09572219848633, 66.40137481689453], [103.05926513671875, 106.83362579345703, 120.10010528564453, 185.40956115722656, 290.85650634765625, 431.2972717285156, 507.6155700683594, 561.8741455078125, 512.5390014648438, 444.4876403808594, 370.3025817871094, 343.0303955078125, 237.0569610595703, 207.94322204589844, 147.5641632080078, 132.46029663085938, 86.20709991455078, 76.19646453857422, 82.0604019165039, 81.1633529663086], [99.01480865478516, 115.5407485961914, 192.8470458984375, 288.93780517578125, 473.3191223144531, 693.0523681640625, 962.0811157226562, 1100.1553955078125, 1101.608642578125, 1035.9129638671875, 781.3710327148438, 615.0018310546875, 381.4979553222656, 309.68365478515625, 222.89523315429688, 165.49005126953125, 122.47413635253906, 104.94537353515625, 82.43269348144531, 61.56951141357422], [99.10176086425781, 143.37713623046875, 227.52870178222656, 405.4568786621094, 647.0301513671875, 1162.0545654296875, 1799.17236328125, 2202.30322265625, 2297.465087890625, 2005.3602294921875, 1594.2025146484375, 1170.425537109375, 768.6690063476562, 546.3087158203125, 331.1956481933594, 245.95208740234375, 161.29652404785156, 125.9578628540039, 95.04777526855469, 94.03402709960938], [110.07882690429688, 167.35845947265625, 230.8756561279297, 426.9753112792969, 890.402099609375, 1706.875, 2861.970703125, 3899.808837890625, 4343.73193359375, 4141.0703125, 3249.46728515625, 2298.413330078125, 1430.9195556640625, 825.9078369140625, 526.4889526367188, 305.438232421875, 190.99476623535156, 148.72679138183594, 118.8472900390625, 88.61616516113281], [122.26171112060547, 148.9236602783203, 297.95489501953125, 549.6630249023438, 1196.8544921875, 2289.87451171875, 4247.03173828125, 6128.20751953125, 7617.3134765625, 7208.541015625, 5966.38720703125, 4289.81396484375, 2617.187744140625, 1487.488037109375, 904.183349609375, 462.3433532714844, 301.65631103515625, 152.72247314453125, 131.01840209960938, 100.74878692626953], [127.99610900878906, 152.2345428466797, 282.7138977050781, 606.8662109375, 1254.206787109375, 2795.20751953125, 5253.1337890625, 8442.6044921875, 10625.9462890625, 11128.6318359375, 9407.8701171875, 6907.72998046875, 4266.1181640625, 2498.166259765625, 1249.3563232421875, 630.0233154296875, 342.5527648925781, 231.24978637695312, 125.58348846435547, 89.40138244628906], [111.58473205566406, 180.7805938720703, 277.5014343261719, 621.8931884765625, 1318.3203125, 2769.18994140625, 5534.955078125, 9423.91015625, 12775.431640625, 14366.30078125, 12703.564453125, 8955.494140625, 5611.14404296875, 3108.42236328125, 1616.3624267578125, 728.6737060546875, 379.9944152832031, 192.14279174804688, 141.71627807617188, 129.92469787597656], [123.6125259399414, 186.75314331054688, 268.1540832519531, 509.0928649902344, 1140.450439453125, 2349.586669921875, 4598.3037109375, 8121.10595703125, 11926.3525390625, 13970.140625, 12813.498046875, 9749.8193359375, 6240.51416015625, 3307.121826171875, 1599.9345703125, 803.4425659179688, 403.16473388671875, 212.4564971923828, 144.90484619140625, 111.141845703125], [111.32501983642578, 165.5951690673828, 229.18002319335938, 387.81201171875, 818.1475830078125, 1621.7652587890625, 3114.81005859375, 5300.0693359375, 8040.49609375, 10096.765625, 9525.748046875, 7770.78369140625, 5165.03955078125, 2820.02490234375, 1333.317138671875, 654.9921875, 324.51226806640625, 228.97398376464844, 152.09011840820312, 116.41755676269531], [105.9477767944336, 144.70443725585938, 195.54458618164062, 294.1975402832031, 514.7661743164062, 898.22021484375, 1705.4796142578125, 2818.39404296875, 4217.54052734375, 5454.40478515625, 5465.3603515625, 4356.9892578125, 3118.2119140625, 1871.268798828125, 955.6302490234375, 455.9709167480469, 275.2216491699219, 160.65548706054688, 125.74334716796875, 99.06786346435547], [89.39866638183594, 116.7323226928711, 147.1670379638672, 213.9594268798828, 319.3274841308594, 554.5100708007812, 851.3333129882812, 1246.9305419921875, 1940.5609130859375, 2331.68505859375, 2396.394287109375, 2088.0673828125, 1525.0447998046875, 947.7273559570312, 563.199951171875, 313.258544921875, 198.99835205078125, 132.00025939941406, 107.30079650878906, 87.20355224609375], [96.55176544189453, 100.65213012695312, 134.08969116210938, 157.15689086914062, 208.56753540039062, 332.8400573730469, 430.7928466796875, 621.2344360351562, 801.0548706054688, 994.8512573242188, 1040.5152587890625, 849.4609375, 706.2031860351562, 494.757080078125, 356.1085205078125, 204.86029052734375, 159.60818481445312, 109.82556915283203, 106.67835998535156, 83.44551086425781], [73.76160430908203, 84.55005645751953, 102.41067504882812, 111.03093719482422, 167.34417724609375, 206.64456176757812, 235.6640625, 339.7917785644531, 407.9351501464844, 452.4277038574219, 434.2862854003906, 385.67718505859375, 369.0739440917969, 274.0387268066406, 182.3013916015625, 138.66989135742188, 114.20000457763672, 110.03865051269531, 90.34402465820312, 88.88838195800781], [62.559566497802734, 80.0523910522461, 107.21296691894531, 87.1720962524414, 126.00232696533203, 124.89905548095703, 122.83074951171875, 184.4443359375, 224.9241180419922, 241.10606384277344, 192.73170471191406, 232.20191955566406, 179.09457397460938, 149.52685546875, 137.1333770751953, 121.16934204101562, 97.46773529052734, 71.56413269042969, 74.3650131225586, 72.53341674804688], [73.68951416015625, 65.09404754638672, 82.27345275878906, 73.3403091430664, 94.1781997680664, 106.94021606445312, 122.86217498779297, 133.53271484375, 139.61001586914062, 154.4224090576172, 157.51564025878906, 133.45062255859375, 139.54306030273438, 126.90926361083984, 113.90974426269531, 85.16282653808594, 82.09255981445312, 69.17615509033203, 57.11660385131836, 52.85169982910156], [74.53111267089844, 82.3466567993164, 65.16752624511719, 65.13605499267578, 81.87547302246094, 69.83425903320312, 101.5262222290039, 101.69881439208984, 134.02268981933594, 120.56649017333984, 86.63323211669922, 112.78681945800781, 103.3613052368164, 95.7742919921875, 87.62965393066406, 71.09259796142578, 65.67567443847656, 76.70916748046875, 80.34854888916016, 62.48930740356445], [66.39701843261719, 67.95259094238281, 66.26465606689453, 66.80745697021484, 67.29170989990234, 75.15901184082031, 80.03498077392578, 94.07147979736328, 82.77811431884766, 101.56461334228516, 93.67501068115234, 83.7899169921875, 86.15371704101562, 78.71997833251953, 74.13490295410156, 53.05218505859375, 65.4153823852539, 75.43292999267578, 53.52924346923828, 66.62939453125]], [[57.67158889770508, 77.65497589111328, 81.67998504638672, 101.70130920410156, 83.68278503417969, 106.57349395751953, 104.62146759033203, 110.19377136230469, 121.3373031616211, 120.48898315429688, 132.7335968017578, 123.84209442138672, 106.20868682861328, 95.6027603149414, 80.08028411865234, 84.95645904541016, 66.72620391845703, 67.10770416259766, 59.040653228759766, 57.942962646484375], [69.18140411376953, 90.4151840209961, 100.26117706298828, 114.55702209472656, 109.65570831298828, 126.41577911376953, 149.3966827392578, 136.8291473388672, 161.61398315429688, 164.02316284179688, 150.521728515625, 137.2364959716797, 100.48082733154297, 117.91566467285156, 91.10752868652344, 64.02580261230469, 76.76760864257812, 66.75263214111328, 68.74288177490234, 70.85614776611328], [86.2743148803711, 100.33161163330078, 115.3868179321289, 143.82150268554688, 178.12062072753906, 202.00006103515625, 249.11639404296875, 261.00775146484375, 269.35589599609375, 251.92495727539062, 243.01402282714844, 204.35841369628906, 133.03060913085938, 161.09402465820312, 120.29247283935547, 114.59693908691406, 72.71627044677734, 70.85306549072266, 65.67859649658203, 68.52861022949219], [74.6746826171875, 109.04216766357422, 152.20254516601562, 207.7154083251953, 278.1070861816406, 324.2838134765625, 452.2238464355469, 510.5888977050781, 485.37060546875, 475.78662109375, 415.2410888671875, 379.3529357910156, 286.41986083984375, 241.8599395751953, 166.06625366210938, 142.4230499267578, 93.6164779663086, 75.56013488769531, 66.25225830078125, 66.62165832519531], [85.0015869140625, 129.85043334960938, 199.41041564941406, 309.13836669921875, 435.6290283203125, 644.2052001953125, 842.9867553710938, 995.4873657226562, 1055.039794921875, 1062.78955078125, 874.375, 689.5786743164062, 541.1568603515625, 400.24591064453125, 241.640380859375, 175.818359375, 140.5255584716797, 102.73896789550781, 79.81854248046875, 59.90241241455078], [95.03937530517578, 146.7328643798828, 238.04345703125, 401.626708984375, 711.3666381835938, 1133.2059326171875, 1616.001220703125, 2028.1292724609375, 2247.91650390625, 2140.056640625, 1913.481689453125, 1442.716552734375, 1042.3526611328125, 705.0882568359375, 492.5801086425781, 280.18048095703125, 192.8257598876953, 134.62933349609375, 126.00067138671875, 86.42532348632812], [99.46004486083984, 175.69256591796875, 266.9491271972656, 541.763916015625, 1048.162841796875, 1939.89794921875, 3064.505859375, 3996.55029296875, 4518.44482421875, 4354.3994140625, 3991.674560546875, 2864.783203125, 2030.44775390625, 1283.1923828125, 822.62841796875, 457.263671875, 260.8733825683594, 182.75636291503906, 119.36711120605469, 80.97712707519531], [123.06777954101562, 173.62335205078125, 355.3804626464844, 669.2850341796875, 1428.067626953125, 2818.708984375, 4620.845703125, 6629.07177734375, 8011.587890625, 8107.31884765625, 6930.40234375, 5490.02294921875, 3793.583984375, 2224.93212890625, 1276.409423828125, 652.3076171875, 329.3366394042969, 212.32513427734375, 129.9966583251953, 91.46575164794922], [132.52699279785156, 187.24844360351562, 352.028564453125, 728.604248046875, 1589.41552734375, 3385.26806640625, 6036.53173828125, 8987.5595703125, 10972.2900390625, 11603.201171875, 10221.0888671875, 8249.0478515625, 5794.970703125, 3458.902099609375, 1756.518798828125, 856.7702026367188, 436.13641357421875, 243.62242126464844, 142.7152099609375, 108.31372833251953], [130.4902801513672, 176.531494140625, 348.8743896484375, 670.0105590820312, 1535.0240478515625, 3132.315673828125, 6004.6064453125, 9642.091796875, 12122.7529296875, 13036.845703125, 11969.291015625, 9443.5146484375, 6529.66796875, 3920.42041015625, 1964.6585693359375, 933.544921875, 485.1812438964844, 233.82542419433594, 136.3810272216797, 85.35916137695312], [119.18358612060547, 178.4211883544922, 311.3474426269531, 570.0949096679688, 1176.07080078125, 2354.24609375, 4748.81005859375, 7404.89794921875, 10209.5361328125, 11374.2314453125, 10858.130859375, 8544.048828125, 5802.8427734375, 3507.053955078125, 1748.2138671875, 784.5239868164062, 421.778564453125, 236.6329803466797, 177.38516235351562, 94.9253158569336], [129.15940856933594, 156.12222290039062, 257.2689514160156, 430.6924133300781, 785.699951171875, 1531.677978515625, 2996.96142578125, 4616.4462890625, 6333.81884765625, 7543.38134765625, 7237.8173828125, 5782.44140625, 4037.19775390625, 2428.212158203125, 1234.7847900390625, 649.2709350585938, 344.5445861816406, 173.1097869873047, 143.0660400390625, 122.85133361816406], [116.50868225097656, 160.78492736816406, 186.47024536132812, 310.3105163574219, 564.3876953125, 940.8518676757812, 1490.2625732421875, 2448.82861328125, 3253.697265625, 4101.22216796875, 3760.25341796875, 3201.11767578125, 2240.73046875, 1344.6270751953125, 781.533203125, 456.502197265625, 279.9316711425781, 147.25759887695312, 116.169677734375, 81.90556335449219], [88.7211685180664, 130.36097717285156, 148.85606384277344, 202.54660034179688, 349.13787841796875, 535.14453125, 822.0428466796875, 1200.6827392578125, 1547.96044921875, 1840.9569091796875, 1743.746826171875, 1498.5010986328125, 1104.305908203125, 726.549072265625, 444.98388671875, 264.433837890625, 163.91026306152344, 122.08368682861328, 90.84706115722656, 68.53303527832031], [77.32180786132812, 73.41758728027344, 116.6509780883789, 148.73707580566406, 220.4025115966797, 303.6679992675781, 430.90606689453125, 577.9132690429688, 731.8404541015625, 760.4979858398438, 782.2987670898438, 726.4929809570312, 500.1607666015625, 358.9097595214844, 257.0103454589844, 162.36181640625, 138.9344482421875, 91.10791015625, 76.30793762207031, 75.98377227783203], [69.55689239501953, 93.42459869384766, 96.55377960205078, 132.91204833984375, 151.81365966796875, 222.3592987060547, 257.3694152832031, 319.2189636230469, 384.9617004394531, 341.0164794921875, 355.9542236328125, 349.30523681640625, 280.3728942871094, 226.89808654785156, 170.71127319335938, 135.10568237304688, 107.85250091552734, 93.25218200683594, 80.36588287353516, 82.84432983398438], [58.14099884033203, 94.6978530883789, 89.12264251708984, 77.43357849121094, 119.90556335449219, 108.28185272216797, 139.09439086914062, 167.3183135986328, 172.19866943359375, 218.97662353515625, 191.71299743652344, 201.19241333007812, 173.3382110595703, 152.4490509033203, 116.99039459228516, 124.11856842041016, 86.1863021850586, 63.63433837890625, 62.543949127197266, 58.35055923461914], [64.90129089355469, 68.60637664794922, 59.5884895324707, 87.02435302734375, 73.63402557373047, 96.44103240966797, 103.32079315185547, 123.35266876220703, 127.58531951904297, 129.29327392578125, 121.37711334228516, 146.2139892578125, 125.2239990234375, 105.12399291992188, 100.98162841796875, 80.65259552001953, 63.28445053100586, 67.7420425415039, 47.92321014404297, 60.56949234008789], [71.40979766845703, 67.71602630615234, 66.61316680908203, 74.7105712890625, 82.44857025146484, 70.85638427734375, 69.85015869140625, 106.55118560791016, 104.70059967041016, 108.08206939697266, 94.7549819946289, 93.72120666503906, 88.95429992675781, 93.15140533447266, 100.22930145263672, 87.63666534423828, 80.77254486083984, 85.21797180175781, 52.62236022949219, 51.230838775634766], [44.68558883666992, 39.414485931396484, 71.1987075805664, 62.77574920654297, 64.22260284423828, 76.73628234863281, 65.3759994506836, 78.96998596191406, 85.61679077148438, 79.9809799194336, 92.51056671142578, 81.96640014648438, 99.82585906982422, 76.72352600097656, 69.41642761230469, 83.23556518554688, 64.95378875732422, 76.84717559814453, 72.11487579345703, 56.32320785522461]]])

crop_side = 20

import matplotlib.gridspec as gridspec
fig = plt.figure(figsize=(15, 12))
gs = gridspec.GridSpec(10, 12)

# fig, ax = plt.subplots(2, 3, figsize=(5, 5))
for i in range(5):
    print(i)
    # median, std = np.median(stars[i]), np.std(stars[i])
    ax = fig.add_subplot(gs[i])
    ax.imshow(
        stars[i], cmap=plt.cm.viridis, interpolation='nearest',
        origin='lower')#, vmin=0., vmax=median + 3. * std)

# # (nstars, ny, nx) pixel coordinates relative to each centroid
# # pixel coordinates (integer)
# x, y = np.mgrid[:crop_side, :crop_side]
# # centroids (float)
# cx, cy = np.array([1.] * len(stars)), np.array([1.] * len(stars))
# dx = cx[:, None, None] + x[None, ...]
# dy = cy[:, None, None] + y[None, ...]

# # 2D weighted histogram
# bins = np.linspace(0., crop_side, crop_side)
# h, xe, ye = np.histogram2d(dx.ravel(), dy.ravel(), bins=bins,
#                            weights=stars.ravel())
# fig, ax = plt.subplots(1, 1, subplot_kw={'aspect': 'equal'})
# ax.hold(True)
# median, std = np.median(h), np.std(h)
# ax.imshow(h, cmap=plt.cm.viridis, interpolation='nearest',
#           origin='lower')#, vmin=0., vmax=median + 3. * std)
# ax.axhline(int(crop_side / 2.) - 1, ls='--', lw=2, c='w')
# ax.axvline(int(crop_side / 2.) - 1, ls='--', lw=2, c='w')

# plt.show()
fig.tight_layout()
plt.savefig('test.png', dpi=300)
